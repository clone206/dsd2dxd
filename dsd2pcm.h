/*

Copyright 2009, 2011 Sebastian Gesemann. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are
permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, this list of
      conditions and the following disclaimer.

   2. Redistributions in binary form must reproduce the above copyright notice, this list
      of conditions and the following disclaimer in the documentation and/or other materials
      provided with the distribution.

THIS SOFTWARE IS PROVIDED BY SEBASTIAN GESEMANN ''AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL SEBASTIAN GESEMANN OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

The views and conclusions contained in the software and documentation are those of the
authors and should not be interpreted as representing official policies, either expressed
or implied, of Sebastian Gesemann.

 */

#ifndef DSD2PCM_H_INCLUDED
#define DSD2PCM_H_INCLUDED

#include <stddef.h>
#include <string.h>

#ifdef __cplusplus
extern "C"
{
#endif

#define FIFOSIZE 128            /* must be a power of two */
#define FIFOMASK (FIFOSIZE - 1) /* bit mask for FIFO offsets */

    /*
     * Properties of this 96-tap lowpass filter when applied on a signal
     * with sampling rate of 44100*64 Hz:
     *
     * () has a delay of 17 microseconds.
     *
     * () flat response up to 48 kHz
     *
     * () if you downsample afterwards by a factor of 8, the
     *    spectrum below 70 kHz is practically alias-free.
     *
     * () stopband rejection is about 160 dB
     *
     * The coefficient tables ("ctables") take only 6 Kibi Bytes and
     * should fit into a modern processor's fast cache.
     */

    /*
     * The 2nd half (48 coeffs) of a 96-tap symmetric lowpass filter
     */
    static const double htaps_d2p[48] = {
        0.09950731974056658,
        0.09562845727714668,
        0.08819647126516944,
        0.07782552527068175,
        0.06534876523171299,
        0.05172629311427257,
        0.0379429484910187,
        0.02490921351762261,
        0.0133774746265897,
        0.003883043418804416,
        -0.003284703416210726,
        -0.008080250212687497,
        -0.01067241812471033,
        -0.01139427235000863,
        -0.0106813877974587,
        -0.009007905078766049,
        -0.006828859761015335,
        -0.004535184322001496,
        -0.002425035959059578,
        -0.0006922187080790708,
        0.0005700762133516592,
        0.001353838005269448,
        0.001713709169690937,
        0.001742046839472948,
        0.001545601648013235,
        0.001226696225277855,
        0.0008704322683580222,
        0.0005381636200535649,
        0.000266446345425276,
        7.002968738383528e-05,
        -5.279407053811266e-05,
        -0.0001140625650874684,
        -0.0001304796361231895,
        -0.0001189970287491285,
        -9.396247155265073e-05,
        -6.577634378272832e-05,
        -4.07492895872535e-05,
        -2.17407957554587e-05,
        -9.163058931391722e-06,
        -2.017460145032201e-06,
        1.249721855219005e-06,
        2.166655190537392e-06,
        1.930520892991082e-06,
        1.319400334374195e-06,
        7.410039764949091e-07,
        3.423230509967409e-07,
        1.244182214744588e-07,
        3.130441005359396e-08};

    static const double htaps_xld[56] = {
        +1.003599032761268994e-01,
        +9.662981560884242871e-02,
        +8.945349213182296477e-02,
        +7.937003090599190069e-02,
        +6.711999843322885573e-02,
        +5.357287880424892179e-02,
        +3.964424879125778151e-02,
        +2.621214413106798952e-02,
        +1.404181427224378970e-02,
        +3.726638223919860951e-03,
        -4.349367691769268421e-03,
        -1.002491923722929022e-02,
        -1.335121721731015974e-02,
        -1.456134879100988953e-02,
        -1.402473061802538001e-02,
        -1.219324909388730047e-02,
        -9.546051479083451571e-03,
        -6.539324989916536768e-03,
        -3.566042373069515121e-03,
        -9.288141542618654628e-04,
        +1.173027324018304039e-03,
        +2.642883925836397949e-03,
        +3.475194700261226202e-03,
        +3.735904314188005001e-03,
        +3.538838154561203993e-03,
        +3.021587525576849027e-03,
        +2.323915921681954030e-03,
        +1.570806204643151061e-03,
        +8.612537902079315079e-04,
        +2.629381379992477125e-04,
        -1.878960137078334030e-04,
        -4.825621199727765783e-04,
        -6.335370394217578393e-04,
        -6.670230543688062102e-04,
        -6.157309569032056416e-04,
        -5.128053356239906969e-04,
        -3.874181080355335862e-04,
        -2.621813014123864261e-04,
        -1.522269998707380064e-04,
        -6.560081853307215519e-05,
        -4.520812542841012188e-06,
        +3.294602930918357880e-05,
        +5.116792066565596268e-05,
        +5.546209091390614230e-05,
        +5.098758042924450833e-05,
        +4.205866389020815099e-05,
        +3.183958589294015248e-05,
        +2.233259319611928908e-05,
        +1.455336859409994022e-05,
        +8.794181965752857413e-06,
        +4.896565360135651024e-06,
        +2.483029535958191067e-06,
        +1.124189775289309014e-06,
        +4.387878673693896045e-07,
        +1.376777283954879050e-07,
        +2.904117154225673850e-08,
    };

    /*
     * The 2nd half (112 coeffs) of a 224-tap symmetric lowpass filter
     *  - flat response up to ~35 kHz
     *  - alias free below ~35 kHz
     *  - stopband rejection ~-160 dB
     */
    static double htaps_16to1_xld[112] = {
        +5.760462813961340911e-02, +5.691757911729226210e-02, +5.555982934698910219e-02, +5.356356970757100017e-02, +5.097584071644974124e-02, +4.785708826560070711e-02, +4.427932021228758730e-02, +4.032393001491144102e-02, +3.607926497084759654e-02, +3.163802486407806674e-02, +2.709458166634984982e-02, +2.254231220535396138e-02, +1.807103341873207009e-02, +1.376462411228964074e-02, +9.698908328714049912e-03, +5.939863928921530062e-03,
        +2.542206329958864031e-03, -4.516178595725602886e-04, -3.012008656370503135e-03, -5.122359614640761838e-03, -6.778787301343743021e-03, -7.989471529052894969e-03, -8.773647602567644088e-03, -9.160302763993922320e-03, -9.186637450460090337e-03, -8.896357660427813702e-03, -8.337867548688329689e-03, -7.562431350066944717e-03, -6.622370993341054196e-03, -5.569360561977704585e-03, -4.452871427796344095e-03, -3.318812840644432948e-03,
        -2.208402475303640131e-03, -1.157290413781186019e-03, -1.949487751238639024e-04, +6.556718097281456770e-04, +1.378228000447144063e-03, +1.962830183962950819e-03, +2.405675727112777888e-03, +2.708501415055656822e-03, +2.877891852193870201e-03, +2.924483152906128154e-03, +2.862101978458481914e-03, +2.706878996383537978e-03, +2.476373319315937002e-03, +2.188740653069128940e-03, +1.861973022276113086e-03, +1.513232339191010987e-03,
        +1.158294059628507027e-03, +8.111110219952220434e-04, +4.835015649465252210e-04, +1.849604310259179106e-04, -7.741400027371707175e-05, -2.988867964233316867e-04, -4.769618051506617756e-04, -6.111814994833964041e-04, -7.028689690242875083e-04, -7.548301317186775859e-04, -7.710338230080065417e-04, -7.562862630242533132e-04, -7.159146274091129480e-04, -6.554722205113200752e-04, -5.804752203233431215e-04, -4.961782711053265614e-04,
        -4.073935045445318940e-04, -3.183550094944409157e-04, -2.326284177570372112e-04, -1.530632418997455091e-04, -8.178395736251813184e-05, -2.021457860897648995e-05, +3.086935161782307266e-05, +7.126786445358902723e-05, +1.012693221865872058e-04, +1.215551028696340054e-04, +1.331019332169323043e-04, +1.370868574255101988e-04, +1.347989395314041930e-04, +1.275608199228540093e-04, +1.166622847621144983e-04, +1.033070589774495030e-04,
        +8.857317092942181480e-05, +7.338651153573718159e-05, +5.850660458614138270e-05, +4.452313192296150120e-05, +3.186146077678470723e-05, +2.079524623147637055e-05, +1.146416398967912983e-05, +3.894913917889374591e-06, -1.976237783286506113e-06, -6.280878589462072164e-06, -9.197003076568571641e-06, -1.092962463456785992e-05, -1.169410169367897026e-05, -1.170252663016168039e-05, -1.115328413493569935e-05, -1.022369729486433082e-05,
        -9.065501913715266297e-06, -7.802825857677858607e-06, -6.532217683647328614e-06, -5.324223752151299107e-06, -4.226118520432855354e-06, -3.265375069810791995e-06, -2.453390583768283789e-06, -1.789251932048668056e-06, -1.263325393243766064e-06, -8.603805222502517747e-07, -5.622136294265281904e-07, -3.498174364819740902e-07, -2.048713691800104068e-07, -1.108150375211134017e-07, -5.349252062858066909e-08, -2.369569955628185962e-08};

    /*
     * The 2nd half (288 coeffs) of a 576-tap symmetric lowpass filter
     *  - flat response up to ~20 kHz
     *  - alias free below ~25 kHz
     *  - stopband rejection ~-160 dB
     */

    static const double htaps_32to1[288] = {
        +2.832187306764930024e-02, +2.824254652547155894e-02, +2.808432323267462047e-02, +2.784805981693616941e-02, +2.753503385413587010e-02, +2.714693509532617108e-02, +2.668585387745912862e-02, +2.615426680982179883e-02, +2.555501984939613849e-02, +2.489130889836478969e-02, +2.416665807665070026e-02, +2.338489584045802885e-02, +2.255012913312142916e-02, +2.166671577126854861e-02, +2.073923528018081081e-02, +1.977245840528879875e-02,
        +1.877131553484789883e-02, +1.774086427655622092e-02, +1.668625643570932973e-02, +1.561270464630398064e-02, +1.452544890578267960e-02, +1.342972326544866063e-02, +1.233072292235590922e-02, +1.123357195589693054e-02, +1.014329194292572060e-02, +9.064771677361208035e-03, +8.002738208179420443e-03, +6.961729398264351887e-03, +5.946068190188035993e-03, +4.959838752272686252e-03, +4.006864657703029797e-03, +3.090689234824688103e-03,
        +2.214558204810868070e-03, +1.381404705106524956e-03, +5.938367750600997974e-04, -1.458726389730360105e-04, -8.357931251922676164e-04, -1.474341678431721064e-03, -2.060285011500399832e-03, -2.592739330986297986e-03, -3.071167626252056804e-03, -3.495374536995716000e-03, -3.865498885199498968e-03, -4.182003972794667845e-03, -4.445665765159678359e-03, -4.657559092152077987e-03, -4.819042016204004228e-03, -4.931738524717999700e-03,
        -4.997519718506597715e-03, -5.018483673850830835e-03, -4.996934165225410361e-03, -4.935358439236965308e-03, -4.836404236456526978e-03, -4.702856256539406955e-03, -4.537612266426255953e-03, -4.343659045449917849e-03, -4.124048362213557709e-03, -3.881873170101666787e-03, -3.620244204366478060e-03, -3.342267154209461934e-03, -3.051020576317987898e-03, -2.749534703197336824e-03, -2.440771292077904830e-03, -2.127604643498118894e-03,
        -1.812803909572205949e-03, -1.499016794767284036e-03, -1.188754739724831068e-03, -8.843796622609676611e-04, -5.880923159878271786e-04, -3.019223094748012953e-04, -2.771981672196853147e-05, +2.328510093090354054e-04, +4.783169194379940079e-04, +7.073987641151111699e-04, +9.190130312632209530e-04, +1.112271769238554978e-03, +1.286480949839729007e-03, +1.441137339257558998e-03, +1.575923953338351094e-03, +1.690704186375274927e-03,
        +1.785514708046237074e-03, +1.860557233238480926e-03, +1.916189274480494973e-03, +1.952913992156397101e-03, +1.971369261884552831e-03, +1.972316081386773189e-03, +1.956626439645925940e-03, +1.925270773672532916e-03, +1.879305134991131072e-03, +1.819858188096574059e-03, +1.748118159472859074e-03, +1.665319851382668966e-03, +1.572731831126691080e-03, +1.471643899726622975e-03, +1.363354937798940932e-03, +1.249161220209139053e-03,
        +1.130345281896554107e-03, +1.008165410318069988e-03, +8.838458312909389363e-04, +7.585676448036903982e-04, +6.334605606403685175e-04, +5.095954720021247247e-04, +3.879778977304505945e-04, +2.695423141347214925e-04, +1.551473879545594930e-04, +4.557211363254804956e-05, -5.848714982121302336e-05, -1.564187572764166965e-04, -2.476969904107944958e-04, -3.318824351965740140e-04, -4.086215575078230183e-04, -4.776455182147663035e-04,
        -5.387682738310591891e-04, -5.918840138196919051e-04, -6.369639885152773850e-04, -6.740527876299678284e-04, -7.032641277165455583e-04, -7.247762138005570121e-04, -7.388267371729673530e-04, -7.457075750184377801e-04, -7.457592557458739410e-04, -7.393652541732076205e-04, -7.269461778585874657e-04, -7.089539070184127561e-04, -6.858657433614849096e-04, -6.581786260972080811e-04, -6.264034645490871179e-04, -5.910596374369238900e-04,
        -5.526697023529318804e-04, -5.117543562206921647e-04, -4.688276814919214910e-04, -4.243927112239643780e-04, -3.789373367108787231e-04, -3.329305828153049135e-04, -2.868192651371369154e-04, -2.410250435838356953e-04, -1.959418791533248873e-04, -1.519338979503454109e-04, -1.093336609274202063e-04, -6.844083620403528401e-05, -2.952126273990103065e-05, +7.193603354780373285e-06, +4.150687831536549813e-05, +7.325609188926600346e-05,
        +1.023127020047189011e-04, +1.285813056036018941e-04, +1.519985706393589032e-04, +1.725319145500247057e-04, +1.901779587762588038e-04, +2.049607845984900895e-04, +2.169300221144472075e-04, +2.261587990345685032e-04, +2.327415789478400943e-04, +2.367919175948391991e-04, +2.384401640618567114e-04, +2.378311335094294033e-04, +2.351217779434990897e-04, +2.304788767650866102e-04, +2.240767720798269929e-04, +2.160951675621174985e-04,
        +2.067170101029857016e-04, +1.961264721050950878e-04, +1.845070473953395931e-04, +1.720397749429781933e-04, +1.589016006967123988e-04, +1.452638850724962988e-04, +1.312910642536376893e-04, +1.171394686019740960e-04, +1.029563003773818032e-04, +8.887877351093520658e-05, +7.503341100148990623e-05, +6.153550051153143063e-05, +4.848870165261734227e-05, +3.598480003610095225e-05, +2.410360151822594151e-05, +1.291295855053903023e-05,
        +2.468918383889056018e-06, -7.184013145816823404e-06, -1.601250765005115149e-05, -2.399395521492089984e-05, -3.111592616541716165e-05, -3.737556186895185775e-05, -4.277890742838695083e-05, -4.734019621224070024e-05, -5.108109986524538059e-05, -5.402994956889200302e-05, -5.622094591580372044e-05, -5.769335894347278203e-05, -5.849073499133671775e-05, -5.866011315443717258e-05, -5.825126296545259699e-05, -5.731594732495138287e-05,
        -5.590722103130646285e-05, -5.407876383363619297e-05, -5.188426189785901754e-05, -4.937683048908486720e-05, -4.660849167063507129e-05, -4.362970031161859664e-05, -4.048892644400089720e-05, -3.723228964006149269e-05, -3.390325110490128029e-05, -3.054235478313806212e-05, -2.718702770133251922e-05, -2.387142394326060915e-05, -2.062632445904036968e-05, -1.747907760208205116e-05, -1.445358715398980996e-05, -1.157033727646837037e-05,
        -8.846458080574018455e-06, -6.295818680620189828e-06, -3.929157252171973044e-06, -1.754227570473739948e-06, +2.240237631741573941e-07, +2.003269670958403207e-06, +3.583595178404888061e-06, +4.967283563592720253e-06, +6.158591065304208374e-06, +7.163523781438434288e-06, +7.989605153551517631e-06, +8.645655922021059845e-06, +9.141567487947644549e-06, +9.488091562562559833e-06, +9.696631517220285660e-06, +9.779049329335696517e-06,
        +9.747480310794938088e-06, +9.614167244464591190e-06, +9.391299843338294523e-06, +9.090880843396395889e-06, +8.724594355736636002e-06, +8.303701327506392776e-06, +7.838941789073578681e-06, +7.340457950486000819e-06, +6.817728374480834957e-06, +6.279521753606318258e-06, +5.733855923492686614e-06, +5.187982122765973032e-06, +4.648366564206547802e-06, +4.120696806411627361e-06, +3.609887898458663985e-06, +3.120103103878763992e-06,
        +2.654779859917369158e-06, +2.216665275032597026e-06, +1.807850545720459064e-06, +1.429821746494539930e-06, +1.083498450311866066e-06, +7.692908715604939946e-07, +4.871471467434027954e-07, +2.366065597327929097e-07, +1.685298747544682079e-08, -1.732343427836944947e-07, -3.350338561481026136e-07, -4.701273358362828907e-07, -5.802636066524420439e-07, -6.673070867471868495e-07, -7.332020304139356636e-07, -7.799366405940304219e-07,
        -8.095047672834952274e-07, -8.238824329747376403e-07, -8.250008741034842748e-07, -8.147207590728109846e-07, -7.948230056574863639e-07, -7.669837851706851544e-07, -7.327663071654264482e-07, -6.936164634597962917e-07, -6.508435222985967835e-07, -6.056342016160503943e-07, -5.590400950831992114e-07, -5.119819580367899411e-07, -4.652602101145172060e-07, -4.195480307943062800e-07, -3.753998202582935077e-07, -3.332724301320836108e-07,
        -2.934992650879649092e-07, -2.563468124086172886e-07, -2.219805813833762934e-07, -1.904989412997169059e-07, -1.619409995434067118e-07, -1.362810288919094114e-07, -1.134353071512805988e-07, -9.332323773092096349e-08, -7.575343334062521977e-08, -6.062291042937457074e-08, -4.771030411192680066e-08, -3.683224038816808700e-08, -2.779864972391978905e-08, -2.040794120555675876e-08, -1.445169688628993990e-08, -1.699951695670444848e-08};

    /*
     * 2nd half of equiripple lowpass filter for use with dsd128
     */
    static const double htaps_ddr_16to1_eq[220] = {
        0.03967918172266,
        0.0394606164597,
        0.03902581868843,
        0.03837942228431,
        0.03752829947255,
        0.036481467901,
        0.0352499690058,
        0.03384671956463,
        0.03228633874548,
        0.03058495332859,
        0.02875998410372,
        0.02682991672145,
        0.02481406049698,
        0.02273229882183,
        0.02060483493458,
        0.01845193684009,
        0.016293685139,
        0.01414972743606,
        0.01203904284613,
        0.009979719913507,
        0.007988751001587,
        0.006081845901772,
        0.004273267064887,
        0.002575688479429,
        0.001000079812008,
        -0.0004443830063868,
        -0.001750380003705,
        -0.002912481898218,
        -0.003927157478668,
        -0.00479275420639,
        -0.005509453024096,
        -0.00607919874062,
        -0.006505607716083,
        -0.006793854893063,
        -0.00695054249374,
        -0.006983552931486,
        -0.006901888669334,
        -0.00671550189079,
        -0.006435116924717,
        -0.006072048391346,
        -0.005638018017095,
        -0.005144972992676,
        -0.004604908628424,
        -0.004029697894774,
        -0.003430930237102,
        -0.002819761821255,
        -0.002206779097369,
        -0.001601877278471,
        -0.001014155028084,
        -0.0004518263335977,
        7.784978080115e-05,
        0.0005686213739312,
        0.001015277527427,
        0.001413664393137,
        0.001760683927189,
        0.002054276154855,
        0.002293386054973,
        0.002477916356866,
        0.002608667726308,
        0.002687267966954,
        0.002716091975713,
        0.002698174256659,
        0.002637115845477,
        0.002536987511846,
        0.002402231063104,
        0.002237560510799,
        0.002047864801493,
        0.001838113671771,
        0.001613268044288,
        0.001378196274424,
        0.001137597307286,
        0.0008959317104508,
        0.0006573612756492,
        0.0004256977494775,
        0.0002043610247501,
        -3.653048274125e-06,
        -0.000195795264436,
        -0.0003699762791039,
        -0.000524570794415,
        -0.0006584132197243,
        -0.0007707854358403,
        -0.0008613973978704,
        -0.0009303613949664,
        -0.0009781608589803,
        -0.001005614652374,
        -0.001013837799369,
        -0.001004199613856,
        -0.0009782801861972,
        -0.0009378261403823,
        -0.000884706540111,
        -0.000820869752405,
        -0.0007483020092783,
        -0.0006689883310961,
        -0.0005848763738523,
        -0.0004978436746766,
        -0.0004096686745776,
        -0.0003220057926326,
        -0.0002363647295458,
        -0.0001540940857295,
        -7.636928654002e-05,
        -4.184726903121e-06,
        6.1650033003e-05,
        0.0001205102553268,
        0.0001719524864702,
        0.0002157078315901,
        0.0002516724235337,
        0.0002798954922116,
        0.0003005654541321,
        0.0003139944539199,
        0.0003206017887601,
        0.000320896633556,
        0.0003154604638123,
        0.0003049295522909,
        0.0002899778855706,
        0.0002713008064835,
        0.0002495996486132,
        0.000225567591644,
        0.00019987692126,
        0.0001731678312222,
        0.0001460388613902,
        0.0001190390273955,
        9.266165736204e-05,
        6.733991039178e-05,
        4.344391972319e-05,
        2.127947719273e-05,
        1.088149248552e-06,
        -1.695130914543e-05,
        -3.272039061816e-05,
        -4.615727858441e-05,
        -5.725246273313e-05,
        -6.604369781204e-05,
        -7.261047433301e-05,
        -7.70681623827e-05,
        -7.956198302521e-05,
        -8.026095471347e-05,
        -7.935194688015e-05,
        -7.703395586845e-05,
        -7.351270476482e-05,
        -6.899565390495e-05,
        -6.368748946344e-05,
        -5.778613863114e-05,
        -5.147934604603e-05,
        -4.494183136099e-05,
        -3.83330304094e-05,
        -3.179540829164e-05,
        -2.545332361495e-05,
        -1.941241288141e-05,
        -1.375945316718e-05,
        -8.562654083797e-06,
        -3.872327816564e-06,
        2.781171917912e-07,
        3.870917726378e-06,
        6.902491590107e-06,
        9.381822289858e-06,
        1.132874506586e-05,
        1.277218648283e-05,
        1.374840497125e-05,
        1.429927130747e-05,
        1.447062356022e-05,
        1.431072870375e-05,
        1.386887538931e-05,
        1.319411404488e-05,
        1.233415643422e-05,
        1.133444419204e-05,
        1.023738869134e-05,
        9.081778005126e-06,
        7.902344901689e-06,
        6.729488942691e-06,
        5.589140268567e-06,
        4.502748737573e-06,
        3.487383282925e-06,
        2.555927219135e-06,
        1.717351603692e-06,
        9.770481404248e-07,
        3.372061827957e-07,
        -2.027803495953e-07,
        -6.458906222316e-07,
        -9.97054039128e-07,
        -1.262737089815e-06,
        -1.450547837654e-06,
        -1.568866778101e-06,
        -1.626511987927e-06,
        -1.632441841297e-06,
        -1.595496349857e-06,
        -1.524179487416e-06,
        -1.426485084596e-06,
        -1.309762706114e-06,
        -1.18061990962e-06,
        -1.044860741083e-06,
        -9.074575386942e-07,
        -7.725500134175e-07,
        -6.434667011015e-07,
        -5.227674570433e-07,
        -4.123017132376e-07,
        -3.132780348736e-07,
        -2.263398986069e-07,
        -1.516459946938e-07,
        -8.895334695492e-08,
        -3.769764777537e-08,
        2.931841559903e-09,
        3.392069378243e-08,
        5.636475709727e-08,
        7.141409087706e-08,
        8.02256191387e-08,
        8.392411935038e-08,
        8.356892115526e-08,
        8.013197318099e-08,
        7.44818401009e-08,
        6.737456790105e-08,
        5.944849500251e-08,
        5.122635461145e-08,
        4.312103866884e-08,
        3.544320356457e-08,
        2.841069361226e-08,
        2.216105556684e-08,
        1.676469695895e-08,
        1.223667243522e-08,
        8.548204152084e-09,
        5.638813366603e-09,
        5.209252174493e-09};

    // static const double htaps_ddr_16to1_eq[52] = {
    //     0.03111406239412,
    //     0.03095727694313,
    //     0.03064590208164,
    //     0.03018428156723,
    //     0.02957881430225,
    //     0.0288378156353,
    //     0.02797134104536,
    //     0.02699097428713,
    //     0.02590958634644,
    //     0.02474107180547,
    //     0.02350007107784,
    //     0.02220168257131,
    //     0.02086117583577,
    //     0.01949371054844,
    //     0.01811406943377,
    //     0.01673640939177,
    //     0.01537403990899,
    //     0.01403922779547,
    //     0.01274303808446,
    //     0.01149520779286,
    //     0.01030405667835,
    //     0.009176437648701,
    //     0.008117717595957,
    //     0.007131797660444,
    //     0.00622116156075,
    //     0.005386952643629,
    //     0.004629073930897,
    //     0.003946310036463,
    //     0.003336459987072,
    //     0.002796483449419,
    //     0.002322649138255,
    //     0.001910687405995,
    //     0.001555934390284,
    //     0.001253476794677,
    //     0.0009982753056132,
    //     0.0007852924033284,
    //     0.0006095843501417,
    //     0.0004663964715626,
    //     0.0003512343887719,
    //     0.0002599129271295,
    //     0.0001886022972679,
    //     0.0001338502870783,
    //     9.259287081426e-05,
    //     6.215234617877e-05,
    //     4.022873687742e-05,
    //     2.487846273768e-05,
    //     1.448921634444e-05,
    //     7.748983474483e-06,
    //     3.615764266752e-06,
    //     1.284703791252e-06,
    //     1.611308486411e-07,
    //     -1.249943459809e-06};

    /*
     * 2nd half of chebyshev filter for use with dsd128
     */
    static const double htaps_ddr_16to1_cheb[125] = {
        0.03208166259762,
        0.03192873274455,
        0.03162462134907,
        0.03117279604737,
        0.03057838643868,
        0.02984809954604,
        0.02899010986372,
        0.02801392627403,
        0.02693023857933,
        0.02575074679065,
        0.02448797663396,
        0.02315508497069,
        0.02176565897732,
        0.02033351298583,
        0.01887248685401,
        0.01739624961387,
        0.0159181119426,
        0.01445085072065,
        0.01300654859438,
        0.01159645105687,
        0.01023084311066,
        0.008918947094202,
        0.007668842751575,
        0.006487410116097,
        0.005380295275627,
        0.004351898603093,
        0.003405384581028,
        0.002542711934175,
        0.001764682417844,
        0.001071006298996,
        0.0004603823169017,
        -6.941027574618e-05,
        -0.0005214101107873,
        -0.0008993651163608,
        -0.001207619509259,
        -0.001450998867235,
        -0.001634695658811,
        -0.001764157438213,
        -0.001844979702202,
        -0.001882805161725,
        -0.001883230912763,
        -0.001851724705991,
        -0.001793551222262,
        -0.001713708968509,
        -0.001616878123966,
        -0.001507379396308,
        -0.001389143697414,
        -0.001265692223736,
        -0.001140126330645,
        -0.001015126426292,
        -0.0008929589801297,
        -0.0007754906448691,
        -0.0006642084278448,
        -0.0005602448172414,
        -0.0004644067682108,
        -0.0003772074808559,
        -0.0002988999530065,
        -0.0002295113620018,
        -0.0001688774173715,
        -0.0001166759263546,
        -7.245892261343e-05,
        -3.568282145204e-05,
        -5.736178744314e-06,
        1.803525761956e-05,
        3.630640849558e-05,
        4.975374223489e-05,
        5.903918766939e-05,
        6.479701888918e-05,
        6.762358243592e-05,
        6.806968283861e-05,
        6.663540000357e-05,
        6.37670815068e-05,
        5.985623367066e-05,
        5.524002651888e-05,
        5.020312816886e-05,
        4.498059267054e-05,
        3.976154038394e-05,
        3.469339031909e-05,
        2.988642807937e-05,
        2.541851984926e-05,
        2.133981104619e-05,
        1.767727673294e-05,
        1.4439018726e-05,
        1.161823075813e-05,
        9.196777440651e-06,
        7.148354666714e-06,
        5.441218194653e-06,
        4.040483287893e-06,
        2.910011427428e-06,
        2.013910326472e-06,
        1.317680925885e-06,
        7.890499650448e-07,
        3.985293882774e-07,
        1.197445764106e-07,
        -7.042748315709e-08,
        -1.918711253742e-07,
        -2.61360179318e-07,
        -2.927692913082e-07,
        -2.973404628745e-07,
        -2.83981179626e-07,
        -2.595747817912e-07,
        -2.292878075447e-07,
        -1.968628075456e-07,
        -1.648885004682e-07,
        -1.350420642345e-07,
        -1.083008140896e-07,
        -8.512250839918e-08,
        -6.559506705041e-08,
        -4.955762104792e-08,
        -3.669558081417e-08,
        -2.661286635945e-08,
        -1.888463890677e-08,
        -1.309386432779e-08,
        -8.854874660127e-09,
        -5.826821289553e-09,
        -3.719572632361e-09,
        -2.294234504027e-09,
        -1.360090370742e-09,
        -7.693924627031e-10,
        -4.110983813739e-10,
        -2.043510876368e-10,
        -9.224815001132e-11,
        -3.624024375515e-11,
        -1.133759638274e-11,
        -2.438194340474e-12};

    // static const double htaps_ddr_16to1_cheb[57] = {
    //     0.02543216683243,
    //     0.02533424362767,
    //     0.02513945070578,
    //     0.0248498774268,
    //     0.02446861417789,
    //     0.02399970105789,
    //     0.02344806120716,
    //     0.02281942022336,
    //     0.02212021339268,
    //     0.02135748270945,
    //     0.02053876585,
    //     0.01967197940458,
    //     0.01876529875122,
    //     0.01782703697671,
    //     0.01686552521216,
    //     0.01588899665761,
    //     0.0149054764238,
    //     0.01392267912607,
    //     0.01294791593115,
    //     0.01198801248933,
    //     0.01104923889156,
    //     0.01013725248003,
    //     0.009257054022601,
    //     0.008412957443196,
    //     0.00760857299124,
    //     0.006846803441033,
    //     0.00612985264347,
    //     0.005459245514156,
    //     0.004835858338451,
    //     0.004259958109149,
    //     0.003731249488782,
    //     0.003248927907125,
    //     0.002811737265176,
    //     0.002418030718365,
    //     0.002065833051572,
    //     0.001752903233196,
    //     0.001476795840789,
    //     0.001234920181712,
    //     0.001024596083519,
    //     0.0008431054946896,
    //     0.0006877392112311,
    //     0.0005558382229307,
    //     0.0004448293494587,
    //     0.00035225500613,
    //     0.0002757970977442,
    //     0.0002132951828486,
    //     0.0001627591771501,
    //     0.0001223769715029,
    //     9.05174256038e-05,
    //     6.57292626582e-05,
    //     4.673643301723e-05,
    //     3.243053694651e-05,
    //     2.186089968311e-05,
    //     1.422287766213e-05,
    //     8.844945517439e-06,
    //     5.175071720253e-06,
    //     3.781004681325e-06};

    /*
     * 2nd half of equiripple filter for dsd128 (176.4K)
     */
    static const double htaps_ddr_32to1_eq[250] = {
        0.02306390103769,
        0.02301925502527,
        0.02293013800439,
        0.02279689908003,
        0.0226200596575,
        0.0224003107564,
        0.02213850945376,
        0.02183567447948,
        0.02149298098988,
        0.02111175455211,
        0.02069346437599,
        0.02023971583383,
        0.01975224231313,
        0.01923289645306,
        0.01868364081532,
        0.01810653804746,
        0.01750374059533,
        0.01687748002658,
        0.01623005603088,
        0.01556382515638,
        0.01488118935303,
        0.01418458438813,
        0.01347646819971,
        0.01275930925488,
        0.01203557498142,
        0.01130772033437,
        0.01057817656345,
        0.009849340242658,
        0.009123562620904,
        0.008403139351197,
        0.007690300652044,
        0.006987201952117,
        0.006295915064475,
        0.005618419934464,
        0.004956596999307,
        0.004312220195745,
        0.003686950644143,
        0.003082331036802,
        0.002499780749671,
        0.001940591695296,
        0.001405924926886,
        0.0008968080013227,
        0.0004141331017886,
        -4.134408203409e-05,
        -0.0004690047247887,
        -0.0008683664989726,
        -0.001239082487973,
        -0.001580939399259,
        -0.001893855102501,
        -0.002177875521263,
        -0.002433170909972,
        -0.002660031551788,
        -0.002858862915168,
        -0.003030180310602,
        -0.003174603088232,
        -0.003292848423959,
        -0.003385724743905,
        -0.003454124819864,
        -0.003499018601051,
        -0.003521445843639,
        -0.003522508531813,
        -0.003503363201327,
        -0.003465213209806,
        -0.003409300936463,
        -0.003336900046487,
        -0.003249307797129,
        -0.003147837476401,
        -0.003033810988859,
        -0.002908551631048,
        -0.002773377111738,
        -0.00262959282615,
        -0.002478485450174,
        -0.002321316844335,
        -0.002159318333617,
        -0.001993685347504,
        -0.001825572480156,
        -0.001656088950845,
        -0.00148629451287,
        -0.001317195788309,
        -0.001149743066154,
        -0.0009848275401031,
        -0.0008232790132024,
        -0.000665864044057,
        -0.0005132845511121,
        -0.0003661768471893,
        -0.0002251111119353,
        -9.059127204397e-05,
        3.69447091162e-05,
        0.0001571241654645,
        0.000269638690076,
        0.0003742427598542,
        0.0004707520326958,
        0.0005590413532997,
        0.0006390424814784,
        0.0007107415798319,
        0.000774176475129,
        0.0008294337331663,
        0.0008766455620158,
        0.0009159865816889,
        0.0009476704782918,
        0.0009719465792461,
        0.0009890963643801,
        0.0009994299509158,
        0.001003282565198,
        0.00100101103503,
        0.0009929903164298,
        0.0009796100850862,
        0.0009612714037238,
        0.000938383492418,
        0.0009113606106384,
        0.0008806190744847,
        0.0008465744162772,
        0.0008096387037932,
        0.0007702180263467,
        0.0007287101578619,
        0.0006855024042392,
        0.0006409696389797,
        0.0005954725343509,
        0.0005493559860626,
        0.0005029477373036,
        0.0004565571948005,
        0.0004104744418399,
        0.0003649694387678,
        0.0003202914119569,
        0.0002766684213005,
        0.0002343070997236,
        0.000193392560911,
        0.0001540884593685,
        0.0001165372059672,
        8.086031221543e-05,
        4.71588691387e-05,
        1.551413772298e-05,
        -1.401175227756e-05,
        -4.137500632681e-05,
        -6.654929455233e-05,
        -8.952480342965e-05,
        -0.0001103072240421,
        -0.0001289167003946,
        -0.000145386732127,
        -0.0001597630505685,
        -0.0001721024788687,
        -0.0001824717834898,
        -0.0001909465254198,
        -0.0001976099233397,
        -0.0002025517329364,
        -0.0002058671529092,
        -0.0002076557617015,
        -0.0002080204940172,
        -0.0002070666592716,
        -0.0002049010103334,
        -0.0002016308628093,
        -0.0001973632726497,
        -0.0001922042700035,
        -0.000186258156514,
        -0.0001796268622772,
        -0.0001724093689286,
        -0.0001647011931852,
        -0.0001565939368717,
        -0.0001481748962867,
        -0.0001395267363215,
        -0.0001307272210392,
        -0.0001218490051788,
        -0.0001129594779154,
        -0.0001041206626537,
        -9.538916340682e-05,
        -8.681616099828e-05,
        -7.844744956252e-05,
        -7.032351606141e-05,
        -6.247965327971e-05,
        -5.494610803505e-05,
        -4.774825631661e-05,
        -4.090680657775e-05,
        -3.443802096723e-05,
        -2.835395954645e-05,
        -2.266273622217e-05,
        -1.736878700113e-05,
        -1.247314650257e-05,
        -7.973733205361e-06,
        -3.865630144822e-06,
        -1.41373631231e-07,
        3.208766311187e-06,
        6.196506624921e-06,
        8.835281820369e-06,
        1.113997994402e-05,
        1.31266918073e-05,
        1.481246757644e-05,
        1.621509229994e-05,
        1.735286778251e-05,
        1.824441627278e-05,
        1.890849138361e-05,
        1.936381224476e-05,
        1.962890631121e-05,
        1.972197401376e-05,
        1.966076280167e-05,
        1.946246234861e-05,
        1.914360932606e-05,
        1.872001233962e-05,
        1.820668447049e-05,
        1.76177954738e-05,
        1.696662986542e-05,
        1.626556406278e-05,
        1.552604679865e-05,
        1.475859737571e-05,
        1.397280460626e-05,
        1.317734368314e-05,
        1.237998961703e-05,
        1.158764908817e-05,
        1.080638495296e-05,
        1.004145942658e-05,
        9.297366880961e-06,
        8.577883750964e-06,
        7.886107398791e-06,
        7.224511214568e-06,
        6.594984126404e-06,
        5.998888667564e-06,
        5.437100726938e-06,
        4.910066677095e-06,
        4.417841466804e-06,
        3.960144591091e-06,
        3.536393351154e-06,
        3.145756387419e-06,
        2.787181759836e-06,
        2.459446964092e-06,
        2.161180680227e-06,
        1.890909291891e-06,
        1.647071434391e-06,
        1.428061201399e-06,
        1.232234541596e-06,
        1.057950151392e-06,
        9.035674477507e-07,
        7.674859157047e-07,
        6.481339254117e-07,
        5.440081511273e-07,
        4.536524456834e-07,
        3.756997136432e-07,
        3.08839172475e-07,
        2.518639114712e-07,
        2.036239666618e-07,
        1.630842674295e-07,
        1.292586573899e-07,
        1.012862282235e-07,
        7.833728082499e-08,
        5.972226002345e-08,
        4.475031614888e-08,
        3.290164750661e-08,
        2.359195060153e-08,
        1.649501026942e-08,
        1.107278830569e-08,
        7.562915977443e-09,
        4.895537333617e-09};

    // static const double htaps_ddr_32to1_eq[184] = {
    //     0.02206180870164,
    //     0.02202232709661,
    //     0.02194350955018,
    //     0.02182564668134,
    //     0.02166917261452,
    //     0.02147466284623,
    //     0.02124283142168,
    //     0.02097452739804,
    //     0.02067073069051,
    //     0.02033254729428,
    //     0.01996120382181,
    //     0.01955804159939,
    //     0.01912451010286,
    //     0.01866215997107,
    //     0.01817263553215,
    //     0.01765766692725,
    //     0.01711906184604,
    //     0.01655869697627,
    //     0.01597850913561,
    //     0.01538048622506,
    //     0.01476665799041,
    //     0.01413908665676,
    //     0.01349985751481,
    //     0.01285106951571,
    //     0.01219482580606,
    //     0.01153322450536,
    //     0.01086834947781,
    //     0.01020226137353,
    //     0.009536988887214,
    //     0.008874520287855,
    //     0.008216795271504,
    //     0.007565697199522,
    //     0.006923045695439,
    //     0.006290589736112,
    //     0.005670001154047,
    //     0.005062868676697,
    //     0.004470692451389,
    //     0.003894879197852,
    //     0.003336737744455,
    //     0.002797475396737,
    //     0.002278194637722,
    //     0.001779890603783,
    //     0.001303449060121,
    //     0.0008496450325695,
    //     0.0004191419687631,
    //     1.249157212298e-05,
    //     -0.0003698659037457,
    //     -0.0007276006563386,
    //     -0.001060491946857,
    //     -0.001368426051559,
    //     -0.001651393833083,
    //     -0.001909487675927,
    //     -0.00214289823841,
    //     -0.002351910429753,
    //     -0.002536899358036,
    //     -0.002698325668786,
    //     -0.0028367307059,
    //     -0.002952731320504,
    //     -0.003047014494576,
    //     -0.003120331683202,
    //     -0.003173493098504,
    //     -0.003207361700716,
    //     -0.003222847292576,
    //     -0.003220900373887,
    //     -0.003202506133067,
    //     -0.003168678261191,
    //     -0.00312045313979,
    //     -0.003058883660111,
    //     -0.002985033630945,
    //     -0.002899971970406,
    //     -0.002804767290219,
    //     -0.002700482557123,
    //     -0.002588170075497,
    //     -0.002468866610157,
    //     -0.002343588940649,
    //     -0.002213329444892,
    //     -0.002079052316987,
    //     -0.001941689768873,
    //     -0.001802138841272,
    //     -0.001661258235189,
    //     -0.001519865943201,
    //     -0.001378736587231,
    //     -0.001238599768945,
    //     -0.001100138217615,
    //     -0.0009639866248219,
    //     -0.0008307306053322,
    //     -0.0007009061080603,
    //     -0.0005749990365659,
    //     -0.0004534453378184,
    //     -0.0003366310777646,
    //     -0.000224893224136,
    //     -0.0001185202538262,
    //     -1.775335930701e-05,
    //     7.721247142276e-05,
    //     0.0001662266436166,
    //     0.0002491817002689,
    //     0.0003260110817969,
    //     0.0003966874050033,
    //     0.000461220179783,
    //     0.0005196536358453,
    //     0.0005720643844938,
    //     0.0006185590086348,
    //     0.0006592715297234,
    //     0.0006943611357458,
    //     0.000724009369158,
    //     0.0007484178858473,
    //     0.000767805774902,
    //     0.0007824073327683,
    //     0.0007924692625317,
    //     0.0007982488545627,
    //     0.0008000111975743,
    //     0.0007980273687183,
    //     0.0007925721189166,
    //     0.0007839219624835,
    //     0.0007723533517133,
    //     0.0007581408101483,
    //     0.0007415552938817,
    //     0.0007228629158902,
    //     0.0007023231752389,
    //     0.0006801880552087,
    //     0.0006567006877984,
    //     0.0006320946107256,
    //     0.0006065924837779,
    //     0.0005804059936162,
    //     0.0005537346462815,
    //     0.0005267657627847,
    //     0.0004996738844059,
    //     0.0004726205529291,
    //     0.0004457544393028,
    //     0.0004192109072882,
    //     0.0003931123495099,
    //     0.0003675684666703,
    //     0.0003426760841851,
    //     0.0003185198612167,
    //     0.000295172482602,
    //     0.0002726952820668,
    //     0.00025113830742,
    //     0.0002305415609392,
    //     0.0002109348537794,
    //     0.0001923389557283,
    //     0.0001747659473608,
    //     0.0001582197319904,
    //     0.000142697366707,
    //     0.0001281886435843,
    //     0.0001146776403208,
    //     0.00010214319082,
    //     9.055908952964e-05,
    //     7.989519559454e-05,
    //     7.011789912382e-05,
    //     6.119075912695e-05,
    //     5.307464923219e-05,
    //     4.572907028385e-05,
    //     3.911179370746e-05,
    //     3.317995970885e-05,
    //     2.789023099843e-05,
    //     2.319865861139e-05,
    //     1.906291759266e-05,
    //     1.543962565833e-05,
    //     1.22874747291e-05,
    //     9.566178951682e-06,
    //     7.236462928432e-06,
    //     5.26074839667e-06,
    //     3.603433475192e-06,
    //     2.230615446048e-06,
    //     1.109990776728e-06,
    //     2.117284117023e-07,
    //     -4.92326780945e-07,
    //     -1.027971919886e-06,
    //     -1.418740774243e-06,
    //     -1.688267150203e-06,
    //     -1.852803888764e-06,
    //     -1.934026742416e-06,
    //     -1.945937267228e-06,
    //     -1.902719894883e-06,
    //     -1.817449677812e-06,
    //     -1.701849142268e-06,
    //     -1.564362723771e-06,
    //     -1.412951556197e-06,
    //     -1.254253803196e-06,
    //     -1.094524404917e-06,
    //     -9.380456062504e-07,
    //     -7.884740154415e-07,
    //     -6.480691180042e-07,
    //     -1.368802310204e-06};

    /*
     * 2nd half of chebyshev filter for dsd128 (176.4K)
     */
    static const double htaps_ddr_32to1_cheb[750] = {
        0.01594201167438,
        0.01592707333681,
        0.01589722527268,
        0.01585252463151,
        0.0157930569564,
        0.01571893596728,
        0.01563030327292,
        0.01552732801257,
        0.01541020642827,
        0.01527916136927,
        0.01513444172984,
        0.01497632182234,
        0.0148051006874,
        0.01462110134316,
        0.01442466997597,
        0.01421617507496,
        0.01399600651293,
        0.01376457457647,
        0.01352230894807,
        0.01326965764334,
        0.0130070859064,
        0.01273507506674,
        0.01245412136095,
        0.01216473472266,
        0.01186743754445,
        0.01156276341499,
        0.01125125583549,
        0.01093346691875,
        0.01060995607493,
        0.0102812886875,
        0.00994803478329,
        0.009610767700391,
        0.009270062757622,
        0.00892649592928,
        0.008580642528876,
        0.008233075905454,
        0.007884366156075,
        0.007535078857938,
        0.007185773823542,
        0.006837003882195,
        0.006489313691062,
        0.006143238578842,
        0.005799303425019,
        0.005458021577526,
        0.005119893811484,
        0.004785407331564,
        0.004455034820348,
        0.004129233534884,
        0.003808444453505,
        0.003493091474769,
        0.003183580670215,
        0.002880299592449,
        0.002583616639892,
        0.00229388047932,
        0.002011419527153,
        0.001736541490256,
        0.001469532966814,
        0.001210659107661,
        0.0009601633382638,
        0.0007182671413445,
        0.0004851698999668,
        0.0002610488007174,
        4.605879643099e-05,
        -0.0001596673722643,
        -0.0003560190974759,
        -0.0005429077677136,
        -0.0007202665759164,
        -0.0008880502732166,
        -0.001046234869968,
        -0.001194817285704,
        -0.001333814949827,
        -0.001463265354955,
        -0.001583225564968,
        -0.001693771679917,
        -0.001794998260038,
        -0.001887017711225,
        -0.00196995963439,
        -0.002043970141217,
        -0.002109211138871,
        -0.002165859586287,
        -0.002214106724705,
        -0.002254157285159,
        -0.002286228675643,
        -0.002310550150694,
        -0.002327361966168,
        -0.002336914521923,
        -0.002339467495187,
        -0.002335288967299,
        -0.002324654546533,
        -0.002307846489651,
        -0.002285152824786,
        -0.002256866478228,
        -0.002223284407582,
        -0.002184706743741,
        -0.00214143594402,
        -0.002093775958712,
        -0.002042031413253,
        -0.001986506808081,
        -0.001927505738186,
        -0.001865330134212,
        -0.001800279526926,
        -0.001732650336679,
        -0.001662735189451,
        -0.001590822260873,
        -0.001517194649575,
        -0.001442129781024,
        -0.001365898842941,
        -0.001288766253211,
        -0.001210989161142,
        -0.001132816982722,
        -0.001054490970476,
        -0.0009762438183421,
        -0.0008982993018937,
        -0.0008208719541109,
        -0.0007441667767682,
        -0.0006683789874077,
        -0.0005936938017421,
        -0.0005202862512232,
        -0.0004483210354054,
        -0.0003779524086275,
        -0.0003093241004384,
        -0.0002425692690964,
        -0.0001778104873795,
        -0.0001151597598606,
        -5.471857071903e-05,
        3.4220389173e-06,
        5.918136517103e-05,
        0.0001124889082979,
        0.0001632842134506,
        0.0002115166865768,
        0.0002571453867525,
        0.000300138796294,
        0.000340474570028,
        0.0003781392651304,
        0.0004131280529694,
        0.0004454444144079,
        0.0004750998200347,
        0.0005021133968,
        0.0005265115825371,
        0.0005483277698465,
        0.0005676019408132,
        0.0005843802940152,
        0.0005987148652632,
        0.0006106631434903,
        0.0006202876831844,
        0.0006276557147259,
        0.0006328387539575,
        0.0006359122122774,
        0.0006369550085024,
        0.0006360491837071,
        0.0006332795201926,
        0.0006287331656931,
        0.0006224992638705,
        0.0006146685920977,
        0.0006053332074696,
        0.0005945861019257,
        0.0005825208673065,
        0.0005692313711056,
        0.0005548114436176,
        0.0005393545771195,
        0.0005229536376594,
        0.0005057005899667,
        0.0004876862359305,
        0.0004689999670356,
        0.000449729531079,
        0.0004299608134345,
        0.0004097776330664,
        0.0003892615534414,
        0.0003684917084253,
        0.0003475446431984,
        0.0003264941701687,
        0.0003054112398095,
        0.0002843638262991,
        0.0002634168277911,
        0.0002426319810981,
        0.0002220677905317,
        0.0002017794705941,
        0.0001818189021863,
        0.0001622346019558,
        0.0001430717043764,
        0.0001243719561231,
        0.0001061737222752,
        8.851200385667e-05,
        7.141846620144e-05,
        5.492147761045e-05,
        3.904615775079e-05,
        2.381443523357e-05,
        9.245113794811e-06,
        -4.646053504709e-06,
        -1.784628265157e-05,
        -3.03456702186e-05,
        -4.213709866689e-05,
        -5.321613600685e-05,
        -6.358093041093e-05,
        -7.323210036598e-05,
        -8.217262094602e-05,
        -9.040770677691e-05,
        -9.794469225415e-05,
        -0.0001047929095619,
        -0.0001109635650278,
        -0.0001164696143314,
        -0.0001213256370691,
        -0.0001255477111575,
        -0.0001291532875403,
        -0.0001321610656412,
        -0.0001345908699863,
        -0.0001364635283954,
        -0.0001378007521197,
        -0.0001386250182804,
        -0.0001389594549388,
        -0.0001388277291047,
        -0.0001382539379644,
        -0.000137262503588,
        -0.000135878071348,
        -0.0001341254122608,
        -0.0001320293294345,
        -0.0001296145687861,
        -0.0001269057341667,
        -0.0001239272070094,
        -0.0001207030705935,
        -0.0001172570389963,
        -0.0001136123907823,
        -0.0001097919074599,
        -0.0001058178167156,
        -0.0001017117404157,
        -9.749464735072e-05,
        -9.318681067598e-05,
        -8.880776999011e-05,
        -8.437629797487e-05,
        -7.991037150675e-05,
        -7.542714713753e-05,
        -7.094294082799e-05,
        -6.647321180863e-05,
        -6.203255043013e-05,
        -5.763466985764e-05,
        -5.329240145452e-05,
        -4.901769369383e-05,
        -4.482161442981e-05,
        -4.071435635615e-05,
        -3.670524547352e-05,
        -3.28027523855e-05,
        -2.901450623931e-05,
        -2.53473111263e-05,
        -2.180716475617e-05,
        -1.839927921889e-05,
        -1.512810364895e-05,
        -1.199734860815e-05,
        -9.010012005142e-06,
        -6.16840637273e-06,
        -3.474187327322e-06,
        -9.283830389089e-07,
        1.468575455685e-06,
        3.716823258564e-06,
        5.817030092452e-06,
        7.770368409496e-06,
        9.578481272265e-06,
        1.124345014564e-05,
        1.276776273158e-05,
        1.415428097196e-05,
        1.540620933753e-05,
        1.652706351381e-05,
        1.752063958761e-05,
        1.839098383018e-05,
        1.914236316599e-05,
        1.977923640821e-05,
        2.03062263351e-05,
        2.072809267391e-05,
        2.104970605163e-05,
        2.127602296501e-05,
        2.141206181524e-05,
        2.14628800457e-05,
        2.143355241494e-05,
        2.132915043018e-05,
        2.115472296097e-05,
        2.091527804619e-05,
        2.061576590226e-05,
        2.026106313479e-05,
        1.985595815089e-05,
        1.940513776439e-05,
        1.891317498168e-05,
        1.838451795168e-05,
        1.78234800593e-05,
        1.723423113829e-05,
        1.66207897758e-05,
        1.598701667809e-05,
        1.533660906378e-05,
        1.467309604897e-05,
        1.39998349859e-05,
        1.332000871527e-05,
        1.26366236906e-05,
        1.195250893149e-05,
        1.127031576189e-05,
        1.059251828839e-05,
        9.92141457289e-06,
        9.259128454031e-06,
        8.607611971092e-06,
        7.968648344588e-06,
        7.343855467804e-06,
        6.734689864038e-06,
        6.142451064966e-06,
        5.568286366287e-06,
        5.013195917789e-06,
        4.47803810601e-06,
        3.963535188903e-06,
        3.470279143185e-06,
        2.998737686503e-06,
        2.549260437998e-06,
        2.122085182461e-06,
        1.717344204891e-06,
        1.335070663947e-06,
        9.752049745336e-07,
        6.376011715211e-07,
        3.220332283621e-07,
        2.820130619697e-08,
        -2.44262089184e-07,
        -4.957860633482e-07,
        -7.268554212455e-07,
        -9.38004904535e-07,
        -1.129813593766e-06,
        -1.302899489268e-06,
        -1.457914282935e-06,
        -1.595538331495e-06,
        -1.716475840265e-06,
        -1.821450264907e-06,
        -1.911199937231e-06,
        -1.986473919715e-06,
        -2.048028092072e-06,
        -2.096621471952e-06,
        -2.133012770662e-06,
        -2.15795718368e-06,
        -2.172203414675e-06,
        -2.176490930791e-06,
        -2.171547446023e-06,
        -2.158086628692e-06,
        -2.136806028271e-06,
        -2.108385216113e-06,
        -2.073484134006e-06,
        -2.032741643942e-06,
        -1.986774271986e-06,
        -1.936175138719e-06,
        -1.881513068358e-06,
        -1.823331868367e-06,
        -1.762149771133e-06,
        -1.698459029076e-06,
        -1.632725654461e-06,
        -1.565389295064e-06,
        -1.496863236841e-06,
        -1.427534524724e-06,
        -1.357764192751e-06,
        -1.287887594806e-06,
        -1.218214827373e-06,
        -1.149031235875e-06,
        -1.080597996349e-06,
        -1.013152764417e-06,
        -9.469103837697e-07,
        -8.820636466185e-07,
        -8.187840988699e-07,
        -7.572228830537e-07,
        -6.975116123578e-07,
        -6.39763269437e-07,
        -5.840731239904e-07,
        -5.305196634399e-07,
        -4.791655313803e-07,
        -4.300584688133e-07,
        -3.832322535207e-07,
        -3.387076332748e-07,
        -2.964932489191e-07,
        -2.565865436922e-07,
        -2.189746554906e-07,
        -1.836352890939e-07,
        -1.505375656839e-07,
        -1.196428472997e-07,
        -9.090553416018e-08,
        -6.42738330728e-08,
        -3.969049541935e-08,
        -1.709352346857e-08,
        3.583155985338e-09,
        2.240905142459e-08,
        3.945650039492e-08,
        5.480009761395e-08,
        6.851615754213e-08,
        8.068221137622e-08,
        9.137653825739e-08,
        1.006777303316e-07,
        1.086642911588e-07,
        1.154142668389e-07,
        1.210049091078e-07,
        1.255123695527e-07,
        1.290114240057e-07,
        1.315752260946e-07,
        1.332750888632e-07,
        1.341802933123e-07,
        1.343579226707e-07,
        1.338727211628e-07,
        1.327869760147e-07,
        1.311604214188e-07,
        1.29050163167e-07,
        1.265106226578e-07,
        1.235934989858e-07,
        1.203477478314e-07,
        1.168195758855e-07,
        1.130524495624e-07,
        1.090871167827e-07,
        1.049616406362e-07,
        1.007114437696e-07,
        9.636936238195e-08,
        9.196570874956e-08,
        8.752834124769e-08,
        8.308274087834e-08,
        7.865209336251e-08,
        7.425737590222e-08,
        6.991744776667e-08,
        6.564914390666e-08,
        6.14673708509e-08,
        5.738520418784e-08,
        5.341398698609e-08,
        4.956342855538e-08,
        4.584170299829e-08,
        4.225554705032e-08,
        3.88103567517e-08,
        3.551028253943e-08,
        3.235832239113e-08,
        2.935641269424e-08,
        2.650551655402e-08,
        2.380570929235e-08,
        2.125626092549e-08,
        1.885571544401e-08,
        1.660196675025e-08,
        1.449233113998e-08,
        1.252361624311e-08,
        1.069218636554e-08,
        8.994024198944e-09,
        7.424788888036e-09,
        5.979870466211e-09,
        4.654440689323e-09,
        3.443500314866e-09,
        2.341922889375e-09,
        1.344495120735e-09,
        4.459539243599e-10,
        -3.589797571179e-10,
        -1.075570251826e-09,
        -1.709039457699e-09,
        -2.264542019581e-09,
        -2.747143256205e-09,
        -3.161799704917e-09,
        -3.513342149129e-09,
        -3.806460991691e-09,
        -4.045693836452e-09,
        -4.235415140299e-09,
        -4.379827798761e-09,
        -4.482956529739e-09,
        -4.548642922144e-09,
        -4.580542018922e-09,
        -4.582120307231e-09,
        -4.556654992231e-09,
        -4.507234435054e-09,
        -4.436759639923e-09,
        -4.347946680116e-09,
        -4.24332995735e-09,
        -4.125266194283e-09,
        -3.995939065012e-09,
        -3.857364373771e-09,
        -3.71139569734e-09,
        -3.559730412049e-09,
        -3.403916031564e-09,
        -3.245356786913e-09,
        -3.085320385384e-09,
        -2.924944890027e-09,
        -2.76524566639e-09,
        -2.607122347986e-09,
        -2.451365776568e-09,
        -2.298664877788e-09,
        -2.149613437093e-09,
        -2.004716744762e-09,
        -1.864398082917e-09,
        -1.729005030971e-09,
        -1.59881556945e-09,
        -1.474043965394e-09,
        -1.354846425552e-09,
        -1.241326506423e-09,
        -1.133540272816e-09,
        -1.031501199007e-09,
        -9.351848087787e-10,
        -8.445330526591e-10,
        -7.594584224721e-10,
        -6.798478049896e-10,
        -6.055660779166e-10,
        -5.364594527533e-10,
        -4.723585702138e-10,
        -4.13081354873e-10,
        -3.584356365561e-10,
        -3.082215467008e-10,
        -2.622336985071e-10,
        -2.202631601589e-10,
        -1.820992307655e-10,
        -1.475310289294e-10,
        -1.163489040221e-10,
        -8.83456803303e-11,
        -6.331774425152e-11,
        -4.106598465757e-11,
        -2.139659642892e-11,
        -4.121756990178e-12,
        1.093981454125e-11,
        2.396240624074e-11,
        3.511296123873e-11,
        4.455081582563e-11,
        5.242751941397e-11,
        5.888672833957e-11,
        6.406416586621e-11,
        6.808764115122e-11,
        7.107712032943e-11,
        7.314484327684e-11,
        7.439548001856e-11,
        7.492632114781e-11,
        7.482749701854e-11,
        7.418222086405e-11,
        7.306705137403e-11,
        7.155217063179e-11,
        6.970167367113e-11,
        6.757386625575e-11,
        6.522156781425e-11,
        6.269241677777e-11,
        6.002917586667e-11,
        5.727003515502e-11,
        5.444891100841e-11,
        5.15957392405e-11,
        4.873676106728e-11,
        4.589480065545e-11,
        4.308953326269e-11,
        4.033774315293e-11,
        3.765357064023e-11,
        3.50487477704e-11,
        3.253282229037e-11,
        3.0113369683e-11,
        2.779619315929e-11,
        2.558551160171e-11,
        2.348413554249e-11,
        2.149363133959e-11,
        1.961447378156e-11,
        1.784618741112e-11,
        1.618747690695e-11,
        1.46363469044e-11,
        1.319021166916e-11,
        1.184599506455e-11,
        1.060022127246e-11,
        9.449096742603e-12,
        8.388583852835e-12,
        7.414466767613e-12,
        6.522409981265e-12,
        5.708010028771e-12,
        4.966840839512e-12,
        4.29449319942e-12,
        3.686608774512e-12,
        3.138909134346e-12,
        2.647220197813e-12,
        2.207492506262e-12,
        1.815817710435e-12,
        1.468441638473e-12,
        1.161774292473e-12,
        8.923971009987e-13,
        6.570677347877e-13,
        4.527227727875e-13,
        2.764784857636e-13,
        1.25629985207e-13,
        -2.351033796721e-15,
        -1.098197455673e-13,
        -1.989626503776e-13,
        -2.71802859365e-13,
        -3.302060489986e-13,
        -3.7588694187e-13,
        -4.10416185321e-13,
        -4.352275133204e-13,
        -4.51625090051e-13,
        -4.607909458551e-13,
        -4.637924275324e-13,
        -4.615895954932e-13,
        -4.550425099597e-13,
        -4.449183573105e-13,
        -4.318983757957e-13,
        -4.165845472462e-13,
        -3.99506028095e-13,
        -3.811252990513e-13,
        -3.618440181581e-13,
        -3.420085667572e-13,
        -3.219152821162e-13,
        -3.018153741833e-13,
        -2.819195271574e-13,
        -2.624021893352e-13,
        -2.434055570557e-13,
        -2.250432605434e-13,
        -2.07403761083e-13,
        -1.905534702808e-13,
        -1.745396032015e-13,
        -1.593927779549e-13,
        -1.451293748588e-13,
        -1.317536686638e-13,
        -1.192597475024e-13,
        -1.076332322506e-13,
        -9.685280988533e-14,
        -8.689159419887e-14,
        -7.77183269176e-14,
        -6.929843187874e-14,
        -6.159493445938e-14,
        -5.456925794432e-14,
        -4.818190797072e-14,
        -4.239305561264e-14,
        -3.716302907366e-14,
        -3.245272335196e-14,
        -2.8223936635e-14,
        -2.443964157711e-14,
        -2.106419901886e-14,
        -1.806352112564e-14,
        -1.540519035866e-14,
        -1.305854014808e-14,
        -1.099470261675e-14,
        -9.186628206477e-15,
        -7.609081588614e-15,
        -6.238617796748e-15,
        -5.053542103265e-15,
        -4.033856772824e-15,
        -3.161197464391e-15,
        -2.418761719274e-15,
        -1.791231664581e-15,
        -1.264692779261e-15,
        -8.265503121559e-16,
        -4.654447074188e-16,
        -1.711671810436e-16,
        6.542359817268e-17,
        2.524829402629e-16,
        3.972590470199e-16,
        5.061689091246e-16,
        5.848708084007e-16,
        6.383331492205e-16,
        6.708994324752e-16,
        6.863492623818e-16,
        6.879553418685e-16,
        6.785364674435e-16,
        6.605065803412e-16,
        6.359199683219e-16,
        6.065127426995e-16,
        5.737407388289e-16,
        5.388140061959e-16,
        5.027280671547e-16,
        4.662921319125e-16,
        4.301544621953e-16,
        3.948250776902e-16,
        3.60695998368e-16,
        3.28059212587e-16,
        2.97122555881e-16,
        2.680236789063e-16,
        2.408422754729e-16,
        2.156107332093e-16,
        1.923233604424e-16,
        1.709443335339e-16,
        1.514144993747e-16,
        1.336571581596e-16,
        1.175829420749e-16,
        1.030938962262e-16,
        9.008685911218e-17,
        7.845623127304e-17,
        6.809621245776e-17,
        5.890257980869e-17,
        5.077407217487e-17,
        4.361343875413e-17,
        3.732820383599e-17,
        3.183119347073e-17,
        2.70408644184e-17,
        2.288147072322e-17,
        1.928309869721e-17,
        1.618159696377e-17,
        1.351842448473e-17,
        1.124043615116e-17,
        9.299622534011e-18,
        7.652817740987e-18,
        6.261386985755e-18,
        5.090903420649e-18,
        4.110821989421e-18,
        3.294156499557e-18,
        2.61716477146e-18,
        2.059045573102e-18,
        1.601650073326e-18,
        1.229209725955e-18,
        9.280818125257e-19,
        6.865133075433e-19,
        4.944232715746e-19,
        3.432036105583e-19,
        2.255377518866e-19,
        1.352365678396e-19,
        6.70907146567e-20,
        1.673844185917e-20,
        -1.945214668004e-20,
        -4.448743808209e-20,
        -6.084033283876e-20,
        -7.053100550664e-20,
        -7.519743860314e-20,
        -7.615672514604e-20,
        -7.445808623233e-20,
        -7.092849430153e-20,
        -6.62117326913e-20,
        -6.080165976468e-20,
        -5.507038289051e-20,
        -4.929198518813e-20,
        -4.366238721937e-20,
        -3.831586749808e-20,
        -3.333871035552e-20,
        -2.878039774242e-20,
        -2.466271321114e-20,
        -2.098708173258e-20,
        -1.774042819152e-20,
        -1.489980032427e-20,
        -1.243596840578e-20,
        -1.03161840059e-20,
        -8.506253429783e-21,
        -6.972057825963e-21,
        -5.680631163007e-21,
        -4.600889113076e-21,
        -3.704086105606e-21,
        -2.9640642004e-21,
        -2.357345756313e-21,
        -1.863111929793e-21,
        -1.463100629083e-21,
        -1.141450490561e-21,
        -8.84511563273e-22,
        -6.806385304739e-22,
        -5.199783215551e-22,
        -3.942607469105e-22,
        -2.965982084392e-22,
        -2.212984987226e-22,
        -1.636931138191e-22,
        -1.199822906287e-22,
        -8.709707277788e-23,
        -6.257805118216e-23,
        -4.446996757336e-23,
        -3.123106959168e-23,
        -2.16559295113e-23,
        -1.481035618224e-23,
        -9.977017363383e-24,
        -6.610427793946e-24,
        -4.300031432772e-24,
        -2.740201876642e-24,
        -1.706093385558e-24,
        -1.034388825043e-24,
        -6.081047054966e-25,
        -3.447234249014e-25,
        -1.870261165657e-25,
        -9.609446760703e-26,
        -4.603557494704e-26,
        -2.005999763129e-26,
        -7.609735262088e-27,
        -2.556083854469e-27};
    // static const double htaps_ddr_32to1_cheb[250] = {
    //     0.01441164716875,
    //     0.01439698608026,
    //     0.01436770086548,
    //     0.01432386531135,
    //     0.01426558975548,
    //     0.01419302067649,
    //     0.014106340151,
    //     0.01400576517955,
    //     0.01389154688484,
    //     0.0137639695861,
    //     0.01362334975371,
    //     0.0134700348493,
    //     0.01330440205651,
    //     0.01312685690855,
    //     0.01293783181881,
    //     0.01273778452135,
    //     0.01252719642863,
    //     0.01230657091379,
    //     0.0120764315256,
    //     0.01183732014398,
    //     0.01158979508456,
    //     0.01133442916081,
    //     0.01107180771222,
    //     0.01080252660753,
    //     0.01052719023143,
    //     0.01024640946377,
    //     0.009960799659865,
    //     0.009670978640347,
    //     0.009377564699272,
    //     0.009081174638512,
    //     0.008782421836572,
    //     0.008481914359552,
    //     0.008180253121722,
    //     0.007878030102806,
    //     0.007575826628732,
    //     0.007274211722169,
    //     0.006973740528766,
    //     0.006674952824534,
    //     0.006378371609352,
    //     0.006084501791074,
    //     0.00579382896419,
    //     0.005506818286508,
    //     0.005223913456744,
    //     0.004945535795401,
    //     0.004672083430777,
    //     0.004403930591371,
    //     0.004141427005456,
    //     0.003884897408039,
    //     0.003634641154887,
    //     0.003390931942837,
    //     0.003154017635067,
    //     0.002924120189542,
    //     0.002701435688409,
    //     0.002486134465655,
    //     0.002278361329941,
    //     0.002078235879139,
    //     0.00188585290275,
    //     0.00170128286802,
    //     0.001524572485324,
    //     0.001355745348064,
    //     0.001194802642135,
    //     0.001041723919786,
    //     0.000896467932537,
    //     0.0007589735176897,
    //     0.0006291605328408,
    //     0.0005069308327585,
    //     0.0003921692829329,
    //     0.0002847448041045,
    //     0.0001845114421026,
    //     9.130945737455e-05,
    //     4.966428673966e-06,
    //     -7.470163451858e-05,
    //     -0.0001478891761301,
    //     -0.0002147999793133,
    //     -0.0002756460588953,
    //     -0.0003306465651957,
    //     -0.0003800267037367,
    //     -0.00042401667512,
    //     -0.0004628506390961,
    //     -0.0004967657065797,
    //     -0.0005260009630854,
    //     -0.0005507965267706,
    //     -0.0005713926439736,
    //     -0.0005880288248363,
    //     -0.0006009430212949,
    //     -0.0006103708494162,
    //     -0.0006165448577532,
    //     -0.0006196938430894,
    //     -0.0006200422146436,
    //     -0.0006178094075151,
    //     -0.0006132093458612,
    //     -0.0006064499560239,
    //     -0.0005977327295574,
    //     -0.0005872523358493,
    //     -0.0005751962837872,
    //     -0.000561744631695,
    //     -0.0005470697445431,
    //     -0.0005313360972404,
    //     -0.0005147001226291,
    //     -0.0004973101026357,
    //     -0.0004793061008772,
    //     -0.0004608199348884,
    //     -0.0004419751860143,
    //     -0.0004228872449114,
    //     -0.0004036633905152,
    //     -0.0003844029002606,
    //     -0.0003651971892908,
    //     -0.0003461299763517,
    //     -0.0003272774740454,
    //     -0.0003087086011105,
    //     -0.0002904852144016,
    //     -0.0002726623582609,
    //     -0.0002552885290063,
    //     -0.0002384059523032,
    //     -0.0002220508712439,
    //     -0.0002062538430214,
    //     -0.0001910400421575,
    //     -0.0001764295683284,
    //     -0.0001624377569193,
    //     -0.0001490754905326,
    //     -0.000136349509779,
    //     -0.000124262721781,
    //     -0.0001128145049302,
    //     -0.0001020010085481,
    //     -9.181544621494e-05,
    //     -8.224838164295e-05,
    //     -7.328800608556e-05,
    //     -6.492040638571e-05,
    //     -5.71298228795e-05,
    //     -4.989889648057e-05,
    //     -4.32089043778e-05,
    //     -3.703998388319e-05,
    //     -3.137134406718e-05,
    //     -2.61814649149e-05,
    //     -2.144828382874e-05,
    //     -1.714936938976e-05,
    //     -1.326208237227e-05,
    //     -9.763724082395e-06,
    //     -6.631672162757e-06,
    //     -3.843504070395e-06,
    //     -1.377108495018e-06,
    //     7.892149617345e-07,
    //     2.676667477158e-06,
    //     4.305873657343e-06,
    //     5.696814698215e-06,
    //     6.86877157879e-06,
    //     7.840277781917e-06,
    //     8.629081017188e-06,
    //     9.252113405098e-06,
    //     9.725469570679e-06,
    //     1.006439208848e-05,
    //     1.028326371862e-05,
    //     1.039560587543e-05,
    //     1.041408277572e-05,
    //     1.035051072248e-05,
    //     1.021587199158e-05,
    //     1.002033280389e-05,
    //     9.773264881846e-06,
    //     9.483270109148e-06,
    //     9.158207832724e-06,
    //     8.805224369011e-06,
    //     8.430784300134e-06,
    //     8.0407031704e-06,
    //     7.64018121896e-06,
    //     7.233837810456e-06,
    //     6.825746251618e-06,
    //     6.41946870804e-06,
    //     6.018090961347e-06,
    //     5.624256772705e-06,
    //     5.240201643747e-06,
    //     4.867785790479e-06,
    //     4.508526169441e-06,
    //     4.163627418113e-06,
    //     3.834011593314e-06,
    //     3.520346611977e-06,
    //     3.223073318119e-06,
    //     2.942431118077e-06,
    //     2.678482143023e-06,
    //     2.431133913469e-06,
    //     2.200160494847e-06,
    //     1.985222146304e-06,
    //     1.785883476662e-06,
    //     1.601630131997e-06,
    //     1.431884048564e-06,
    //     1.276017312877e-06,
    //     1.133364677662e-06,
    //     1.003234788217e-06,
    //     8.849201784637e-07,
    //     7.777060997551e-07,
    //     6.808782483289e-07,
    //     5.937294592905e-07,
    //     5.155654361794e-07,
    //     4.457095856399e-07,
    //     3.835070265102e-07,
    //     3.283278418566e-07,
    //     2.795696411621e-07,
    //     2.366594981104e-07,
    //     1.990553272346e-07,
    //     1.662467602023e-07,
    //     1.377555797303e-07,
    //     1.131357661235e-07,
    //     9.197320826411e-08,
    //     7.388512758919e-08,
    //     5.851926022568e-08,
    //     4.555283904865e-08,
    //     3.469141402493e-08,
    //     2.566754583338e-08,
    //     1.823940444419e-08,
    //     1.218930111964e-08,
    //     7.322179187668e-09,
    //     3.464085957891e-09,
    //     4.606453113671e-10,
    //     -1.824452186648e-09,
    //     -3.510927318643e-09,
    //     -4.703346404103e-09,
    //     -5.492501827884e-09,
    //     -5.95673108102e-09,
    //     -6.163168301572e-09,
    //     -6.168923942301e-09,
    //     -6.022189659902e-09,
    //     -5.763266822463e-09,
    //     -5.42551817415e-09,
    //     -5.036243186362e-09,
    //     -4.617478470969e-09,
    //     -4.186725342648e-09,
    //     -3.757607203137e-09,
    //     -3.340459890075e-09,
    //     -2.942858496829e-09,
    //     -2.570084437137e-09,
    //     -2.225536709343e-09,
    //     -1.911091418945e-09,
    //     -1.627413654476e-09,
    //     -1.374225789291e-09,
    //     -1.15053620908e-09,
    //     -9.548323499865e-10,
    //     -7.852417825055e-10,
    //     -6.396648987975e-10,
    //     -5.158825621843e-10,
    //     -4.116418630353e-10,
    //     -3.247229003606e-10,
    //     -2.529892777737e-10,
    //     -1.944247701928e-10,
    //     -1.471583872395e-10,
    //     -1.094798337936e-10,
    //     -7.984715010022e-11,
    //     -5.6888105249e-11,
    //     -3.939672040102e-11,
    //     -2.632611304255e-11,
    //     -1.677868168065e-11,
    //     -1.478474799456e-11};

    struct dsd2pcm_ctx_s
    {
        unsigned char fifo[FIFOSIZE];
        unsigned fifopos;
        unsigned int numTables;
        double **ctables;
        int decimation;
        int lsbfirst;
        int delay;
        int delay2;
        int (*translate)(struct dsd2pcm_ctx_s *, size_t, const unsigned char *, ptrdiff_t, float *, ptrdiff_t);
        int (*finalize)(struct dsd2pcm_ctx_s *, float *, ptrdiff_t);
    };

    typedef struct dsd2pcm_ctx_s dsd2pcm_ctx;

    /**
     * initializes a "dsd2pcm engine" for one channel
     * (precomputes tables and allocates memory)
     *
     * This is the only function that is not thread-safe in terms of the
     * POSIX thread-safety definition because it modifies global state
     * (lookup tables are computed during the first call)
     */
    extern dsd2pcm_ctx *dsd2pcm_init(char filtType, int lsbf, int decimation, int dsdRate);

    /**
     * deinitializes a "dsd2pcm engine"
     * (releases memory, don't forget!)
     */
    extern void dsd2pcm_destroy(dsd2pcm_ctx *ctx);

    /**
     * clones the context and returns a pointer to the
     * newly allocated copy
     */
    extern dsd2pcm_ctx *dsd2pcm_clone(dsd2pcm_ctx *ctx);

    /**
     * resets the internal state for a fresh new stream
     */
    extern void dsd2pcm_reset(dsd2pcm_ctx *ctx);

    /**
     * "translates" a stream of octets to a stream of floats
     * (8:1 decimation)
     * @param handle -- pointer to abstract context (buffers)
     * @param blockSize -- number of octets/samples to "translate"
     * @param dsdData -- pointer to first octet (input)
     * @param dsdStride -- src pointer increment
     * @param lsbitfirst -- bitorder, 0=msb first, 1=lsbfirst
     * @param floatData -- pointer to first float (output)
     * @param floatStride -- dst pointer increment
     * @param decimation -- decimation ration (to 1)
     */
    extern void dsd2pcm_translate(dsd2pcm_ctx *handle, size_t blockSize,
                                  const unsigned char *dsdData, ptrdiff_t dsdStride, int lsbitfirst,
                                  double *floatData, ptrdiff_t floatStride, int decimation);

#ifdef __cplusplus
} /* extern "C" */
#endif

#endif /* include guard DSD2PCM_H_INCLUDED */
